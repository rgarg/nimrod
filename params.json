{"name":"Nimrod","body":"# Nimrod 0.5\r\n\r\nNimrod is a metrics server purely based on log processing: hence, it doesn't affect the way you write your applications, nor has it any side effect on them.\r\nIn other words, for those of you who love the bullet points:\r\n\r\n* You don't have to import any libraries: just print some logs in a way that Nimrod is able to process, and run the Nimrod metrics server to process them.\r\n* You can use Nimrod regardless of your programming language of choice.\r\n* Nimrod bugs (yes, any piece of software will sooner or later have bugs) will never affect your application.\r\n\r\nIt currently provides the following features:\r\n\r\n* Continuous logs processing for metrics extraction.\r\n* Different types of metrics with fundamental statistical information, time-series history, and (optional) random sampling.\r\n* Web-based, Javascript-friendly JSON-over-HTTP server, with default support for Cross Origin Resource Sharing on GET requests.\r\n\r\n# Metrics\r\n\r\n## Logging\r\n\r\nNimrod metrics are printed on log files *by the user application*, while the Nimrod metrics server only listens to log and processes them: so,\r\nmetrics production is completely decoupled from metrics processing and storage.\r\n\r\nMetrics must be printed in a Nimrod-specific format, providing the following information in square brackets:\r\n\r\n* The **nimrod** identification string.\r\n* The metric **timestamp**, providing *current unix time in milliseconds*.\r\n* The metric **type**, among one of:\r\n * *alert*\r\n * *gauge*\r\n * *counter*\r\n * *timer*\r\n* The metric **identifier** for the specified type.\r\n* The metric **value**.\r\n* An optional comma-separated list of metric **tags** defining custom information.\r\n\r\nHere's an example, without tags:\r\n\r\n    [nimrod][123456789][counter][players][100]\r\n\r\nBut you can also interleave whatever you want between Nimrod-specific values, in order to make your logs more human-friendly:\r\n\r\n    [nimrod][123456789][counter] - Current number of [players] is: [100]\r\n\r\nAnd with tags:\r\n\r\n    [nimrod][123456789][counter][players][100][game_code:123,game_name:poker]\r\n\r\n## Alerts\r\n\r\nString values representing a generic message at a given time.\r\n\r\nHere's a log line representing an alert value:\r\n\r\n    [nimrod][123456789][alert][top_player][sergio]\r\n\r\nThe Nimrod metrics server also computes and provides the following statistical information:\r\n\r\n* Mean and variance of the elapsed time.\r\n\r\n## Gauges\r\n\r\nNumber values representing a fixed indicator at a given time.\r\n\r\nHere's a log line representing a gauge value:\r\n\r\n    [nimrod][123456789][gauge][current_players][100]\r\n\r\nThe Nimrod metrics server also computes and provides the following statistical information:\r\n\r\n* Mean and variance of time intervals between measure updates.\r\n* Mean and variance of the measure.\r\n\r\n## Counters\r\n\r\nNumber values representing an incrementing value over time, tracking both the latest increment and the overall counter value.\r\n\r\nHere's a log line representing a counter value:\r\n\r\n    [nimrod][123456789][counter][total_players][100]\r\n\r\nThe Nimrod metrics server also computes and provides the following statistical information:\r\n\r\n* Mean and variance of time intervals between counter updates.\r\n* Mean and variance of the counter increment.\r\n\r\n## Timers\r\n\r\nNumber values representing the elapsed time between start and stop of a given event.\r\n\r\nHere's a log line starting a time computation:\r\n\r\n    [nimrod][123456788][timer][login][start]\r\n\r\nAnd here's a log line stopping a previously started time computation:\r\n\r\n    [nimrod][123456789][timer][login][stop]\r\n\r\nElapsed time will be computed over the provided timestamps above (in the example above, the final value will be 1).\r\n\r\nThe Nimrod metrics server also computes and provides the following statistical information:\r\n\r\n* Mean and variance of the elapsed time.\r\n\r\n## Time-series history and sampling\r\n\r\nFor each metric, Nimrod stores all processed values in time-series which you can browse through the Nimrod HTTP interface, or query through external tools \r\nfor monitoring purposes or further statistical analysis.\r\n\r\nBy the way, if your application produces lots of metrics, the time-series could grow very large, so Nimrod provides a random sampling method to reduce the \r\nsize of the time-series history.\r\nThe sampling algorithm is based on two main concepts:\r\n\r\n* Sampling frequency: how many metric values are fully stored before sampling takes place.\r\n* Sampling factor: how much is the full sample reduced. \r\n\r\nNimrod provides an extra guarantee: at any point in time, the latest N metric values, where N is equal to the sampling frequency, will always be fully kept; \r\nthis means you can always rely on the latest N metrics to be completely accurate, which is very useful for monitoring purposes, when you usually want the freshest\r\ndata to be more accurate than the older one, in order to accurately detect anomalies.\r\n\r\nSo to make an example, if you setup a sampling frequency of 10000, and a factor of 10, every time Nimrod collects 10000 metric values the *previous* 10000 \r\nvalues will be sampled and reduced to 1000, while the latest ones will be fully kept and sampled at the next round.\r\n\r\n# Usage\r\n\r\n## Download/Build\r\n\r\nYou can download the latest, ready-to-use, Nimrod binary version as a standalone self-contained jar from [here](https://github.com/downloads/sbtourist/nimrod/nimrod-0.5-standalone.jar).\r\n\r\nOtherwise, you can check it out and build from source yourself:\r\nNimrod is written in wonderful Clojure, and you can build it with the excellent [Leiningen](http://github.com/technomancy/leiningen).\r\nOnce you have Leiningen installed, it is as easy as:\r\n\r\n    $> lein deps && lein uberjar\r\n\r\n## Configuration\r\n\r\nNimrod can be configured by creating and editing a *nimrod.conf* file placed in the same directory where you start the Nimrod process; it is based on the\r\n[HOCON](https://github.com/typesafehub/config) format.\r\n\r\nYou can pre-register log files to process and configure the metrics storage implementation.\r\n\r\nLogs can be pre-registered at startup by providing a *logs* block and a nested block for every log, identified by a unique name, as follows:\r\n\r\n    logs {\r\n        log_identifier_1 { \r\n            source : log_file_path\r\n            interval : tailing_interval_in_millis\r\n            end : true_for_tailing_from_end_false_otherwise\r\n        }\r\n        log_identifier_2 { \r\n            source : log_file_path\r\n            interval : tailing_interval_in_millis\r\n            end : true_for_tailing_from_end_false_otherwise\r\n        }\r\n        // ...\r\n    }\r\n\r\nStorage can be configured by providing the specific implementation, related options and sampling method, as follows:\r\n\r\n    store {\r\n        type : disk\r\n        options {\r\n            \"cache.results\" : number_of_metric_values_cached_during_queries\r\n            \"defrag.limit\" : percentage_of_wasted_space_after_which_defrag_is_executed\r\n        }\r\n        sampling {\r\n            \"metric.frequency\" : sampling_frequency\r\n            \"metric.factor\" : sampling_factor\r\n        }\r\n    }\r\n\r\nHere is a more in-depth explanation: \r\n\r\n* type: currently, only the *disk* implementation is supported (the old *memory* implementation isn't supported anymore).\r\n* \"cache.results\" (quoting is mandatory): how many metric values are cached in memory by a single query to the time-series history; if the query exceeds that value, the results \r\nwill be moved to disk and the query will be slower.\r\n* \"defrag.limit\" (quoting is mandatory): percentage of wasted disk space after which defrag is executed.\r\n* \"metric.frequency\" (quoting is mandatory): sampling frequency for metrics; you can define a sampling frequency for all metrics from a log file\r\nby only specifying the log identifier (i.e. log1), or for all metrics of a given type from a log file by specifying the log identifier followed by a dot \r\nand the metric type (i.e. log1.gauge), or for a specific named metric of a given type from a log file by specifying the log identifier followed by a dot \r\nand the metric type followed by a dot and the metric name (i.e. log1.gauge.requests).\r\n* \"metric.factor\" (quoting is mandatory): sampling factor for metrics, defined in the same way as metric.frequency.\r\n\r\n## Startup\r\n\r\nThe Nimrod metrics server can be easily started as follows (replace \"version\" with the actual Nimrod version and \"8000\" with you port of choice):\r\n\r\n    $> java -cp nimrod-version-standalone.jar nimrod.web.startup 8000\r\n\r\nThis will start the Nimrod web server and log processing activity.\r\n\r\nPlease note that Nimrod must be started on the same machine hosting the logs, in order to listen to and process them.\r\n\r\n## Log files querying and management\r\n\r\nYou can query for registered logs as follows:\r\n\r\n    GET /logs\r\n\r\nAnd you can also stop listening/processing a log that was previously configured:\r\n\r\n    POST /logs/log_id/stop\r\n\r\n## Metrics querying and management\r\n\r\nYou can query all active metric types for a given log as follows:\r\n\r\n    GET /logs/log_id\r\n\r\nOnce you have the metric type, you can query all actual metrics under that log and metric type, as follows:\r\n\r\n    GET /logs/log_id/metric_type\r\n\r\nOnce you have a grasp of available Nimrod metrics by logs and types, specific Nimrod metrics can be queried as follows:\r\n\r\n    GET /logs/log_id/metric_type/metric_id\r\n\r\nHere, *metric_id* is the name of the specific metric you want to read.\r\n\r\nYou will always get the latest metric value, but you can also access its time-series history as follows:\r\n\r\n    GET /logs/log_id/metric_type/metric_id/history\r\n\r\nNimrod also provides a selection of rich APIs for querying and managing the time-series history.\r\n\r\nYou can browse through the history by age:\r\n\r\n    GET /logs/log_id/metric_type/metric_id/history?age=max_age_in_millis\r\n\r\nOr time interval:\r\n\r\n    GET /logs/log_id/metric_type/metric_id/history?from=unix_time_in_millis&to=unix_time_in_millis\r\n\r\nAnd also use tags for filtering the results:\r\n\r\n    GET /logs/log_id/metric_type/metric_id/history?tags=comma_separated_list_of_tags\r\n\r\nTags filtering can be used with both age and interval based queries.\r\n\r\nHistory can be \"pruned\" by deleting values whose latest update happened before a given number of milliseconds:\r\n\r\n    POST /logs/log_id/metric_type/metric_id/history/delete?age=millis\r\n\r\nOr by specifying a time interval:\r\n\r\n    POST /logs/log_id/metric_type/metric_id/history/delete?from=unix_time_in_millis&to=unix_time_in_millis\r\n\r\nHistory can also be aggregated, providing the following summary statistics: count, median and percentiles. \r\nAggregation happens by again specifying the max age:\r\n\r\n    GET /logs/log_id/metric_type/metric_id/history/aggregate?age=max_age_in_millis\r\n\r\nOr time interval:\r\n\r\n    GET /logs/log_id/metric_type/metric_id/history/aggregate?from=unix_time_in_millis&to=unix_time_in_millis\r\n\r\nDesired percentiles can also be specified as follows:\r\n\r\n    GET /logs/log_id/metric_type/metric_id/history/aggregate?percentiles=comma_separated_list_of_percentages_ie_25,50,99\r\n\r\nFinally, metrics can be reset as follows:\r\n\r\n    POST /logs/log_id/metric_type/metric_id/reset\r\n\r\nPlease note that this only resets the latest value, without affecting its history.\r\n\r\n# Other Resources\r\n\r\n* [API Reference](https://github.com/sbtourist/nimrod/wiki/API-Reference)\r\n* [Frequently Asked Questions](https://github.com/sbtourist/nimrod/wiki/Frequently-Asked-Questions)\r\n\r\n# Related Articles\r\n\r\n* [Metrics visibility with Syslog-NG, Nimrod and Nagios](http://metabroadcast.com/blog/logfile-lovin-marrying-nimrod-and-nagios-for-software-visibility)\r\n\r\n# Related Projects\r\n\r\n* [Nimrod-Java](https://github.com/sbtourist/nimrod-java)\r\n* [Nimrod-Incanter](https://github.com/sbtourist/nimrod-incanter)\r\n\r\n# Feedback\r\n\r\nFor everything Nimrod-related, please join the nimrod-user group: http://groups.google.com/group/nimrod-user\r\n\r\n# License\r\n\r\nCopyright (C) 2011-2012 [Sergio Bossa](http://twitter.com/sbtourist)\r\n\r\nDistributed under the [Apache Software License](http://www.apache.org/licenses/LICENSE-2.0.html).\r\n","tagline":"Not Invasive MetRics, Oh Dear!","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}